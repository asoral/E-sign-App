var C=(f,n,l)=>new Promise((v,m)=>{var g=s=>{try{o(l.next(s))}catch(u){m(u)}},x=s=>{try{o(l.throw(s))}catch(u){m(u)}},o=s=>s.done?v(s.value):Promise.resolve(s.value).then(g,x);o((l=l.apply(f,n)).next())});import{u as _,c as O,e as E,r as d,j as e}from"./index-vTrzwfGc.js";import{Q as D}from"./react-toastify.esm-DF0zyQA5.js";import{S as p}from"./index-DDN33i54.js";import"./PurePanel-DNyvZeh-.js";import"./index-D0F_K97b.js";const M=()=>{const f=_(),n=O(E),[l,v]=d.useState([]),[m,g]=d.useState(!0),[x,o]=d.useState(null),[s,u]=d.useState("all"),[j,N]=d.useState(""),S=t=>{f(`/signer/${t.name}`,{state:{documentData:t}})};if(d.useEffect(()=>{n&&C(void 0,null,function*(){try{const r=yield fetch(`/api/method/esign_app.api.get_documents_by_user?user_mail=${n}`,{method:"GET",headers:{"Content-Type":"application/json"}}),a=yield r.json();r.status===200?a.message.data.length>0?v(a.message.data):o("No documents found"):o("Failed to fetch documents")}catch(r){o("An error occurred while fetching documents")}finally{g(!1)}})},[n]),m)return e.jsx("div",{children:"Loading..."});if(x)return e.jsx("div",{children:x});const b=t=>{try{return JSON.parse(t)}catch(r){return console.error("Failed to parse assigned_users:",r),{}}},y=l.filter(t=>{var h;const r=b(t.assigned_users),a=(h=Object.values(r).find(w=>w.email===n))==null?void 0:h.status,i=s==="all"||s==="unseen"&&a==="unseen"||s==="opened"&&a==="open"||s==="completed"&&a==="close",c=t.document_title.toLowerCase().includes(j.toLowerCase());return i&&c});return e.jsxs("div",{className:"relative mt-6 min-w-[1000px] max-w-[1000px] mx-auto",children:[e.jsxs("div",{className:"mb-4 flex gap-2 items-center max-w-40",children:[e.jsx("input",{type:"text",placeholder:"Search by document title...",value:j,onChange:t=>N(t.target.value),className:"border p-2 rounded-md flex-1"}),e.jsxs(p,{value:s,onChange:t=>u(t),className:"min-w-40",children:[e.jsx(p.Option,{value:"all",children:"All"}),e.jsx(p.Option,{value:"opened",children:"Opened"}),e.jsx(p.Option,{value:"completed",children:"Completed"}),e.jsx(p.Option,{value:"unseen",children:"Unseen"})]})]}),e.jsx("div",{className:"h-[90vh] overflow-y-auto",children:e.jsx("div",{className:"flex flex-wrap gap-5",children:y.map((t,r)=>{var h;const a=b(t.assigned_users),i=(h=Object.values(a).find(w=>w.email===n))==null?void 0:h.status;let c="";return i==="unseen"?c="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] relative":i==="open"?c="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42]":i==="close"&&(c="bg-[#283C42] text-white border-transparent hover:border-[#283C42] hover:bg-white hover:text-[#283C42] opacity-50"),e.jsx("div",{className:"w-[200px] h-[100px] relative",children:e.jsxs("div",{className:`p-4 rounded border-2 transition-colors duration-300 cursor-pointer ${c}`,onClick:()=>S(t),children:[e.jsx("h3",{className:`mt-2 font-bold ${i==="close"?"line-through":""} text-ellipsis overflow-hidden whitespace-nowrap`,children:t.document_title}),e.jsx("p",{className:"text-sm text-ellipsis overflow-hidden whitespace-nowrap",children:new Date(t.document_created_at).toLocaleString()}),i==="unseen"&&e.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 bg-yellow-500 rounded-full shadow-md"})]})},r)})})}),e.jsx(D,{})]})};export{M as default};
